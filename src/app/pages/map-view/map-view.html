<div class="map-container">
  <iframe
    class="map-iframe"
    width="100%"
    height="100%"
    style="border: 0"
    loading="lazy"
    allowfullscreen
    referrerpolicy="no-referrer-when-downgrade"
    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d58673.07921890356!2d-47.88725831102927!3d-23.3512140669299!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94c5d8e7b165296d%3A0x6a0a09e0a80e1c31!2sTatu%C3%AD%2C%20SP!5e0!3m2!1spt-BR!2sbr!4v1730219812345!5m2!1spt-BR!2sbr"
  >
  </iframe>

  <div class="bottom-sheet" [class.expanded]="isExpanded">
    <div class="handle"></div>

    <div class="expand-button-wrapper">
      <button mat-flat-button class="expand-button" (click)="toggleExpansion()">
        <mat-icon>{{ isExpanded ? 'fullscreen_exit' : 'fullscreen' }}</mat-icon>
        {{ isExpanded ? 'Reduzir' : 'Expandir' }}
      </button>
    </div>

    <mat-tab-group class="list" animationDuration="0ms">
      <mat-tab label="Rotas">
        <div class="tab-content">
          @if(routeItems.length > 0) { @for(item of routeItems; track item.id) {
          <app-map-item-card [item]="item" (cardClick)="onItemClick(item)"></app-map-item-card>
          } } @else {
          <p class="empty-state">Nenhuma rota encontrada.</p>
          }
        </div>
      </mat-tab>

      <mat-tab label="Eventos">
        <div class="tab-content">
          @if(eventItems.length > 0) { @for(item of eventItems; track item.id) {
          <app-map-item-card [item]="item" (cardClick)="onItemClick(item)"></app-map-item-card>
          } } @else {
          <p class="empty-state">Nenhum evento encontrado.</p>
          }
          <button mat-stroked-button class="see-more-button">
            Ver mais eventos na regi√£o <mat-icon>expand_more</mat-icon>
          </button>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
  <app-bottom-menu></app-bottom-menu>
</div>
