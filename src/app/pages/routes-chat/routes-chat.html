<app-header-title
  title="Criar um Roteiro"
  [showBackButton]="true"
  [showResetButton]="true"
  (backClick)="goBack()"
  (resetClick)="reset()"
></app-header-title>

<div class="chat-container">
  <div class="chat-content" #chatContent>
    @for(msg of messages; track $index) { @switch (msg.type) { @case ('text') {
    <app-chat-bubble [message]="msg"></app-chat-bubble>
    } @case ('loading') {
    <app-chat-bubble [message]="msg"></app-chat-bubble>
    } @case ('image-carousel') {
    <app-image-carousel [images]="msg.images!"></app-image-carousel>
    } @case ('card-carousel') {
    <app-card-carousel [items]="msg.items!"></app-card-carousel>
    } } }
  </div>

  <div class="chat-input-footer">
    <div class="suggestion-chips-container">
      <mat-chip-listbox aria-label="SugestÃµes de Roteiro">
        @for(tip of suggestions; track tip) {
        <mat-chip-option (click)="sendSuggestion(tip)">{{ tip }}</mat-chip-option>
        }
      </mat-chip-listbox>
    </div>

    <div class="input-bar">
      <mat-form-field appearance="outline" class="message-input">
        <input
          matInput
          [(ngModel)]="currentMessage"
          (keyup.enter)="sendMessage()"
          placeholder="Pergunte sobre um roteiro..."
        />
      </mat-form-field>

      <button mat-icon-button class="action-button" (click)="saveRoute()">
        <mat-icon>save</mat-icon>
      </button>

      <button
        mat-icon-button
        class="send-button"
        (click)="sendMessage()"
        [disabled]="currentMessage.trim() === '' || isLoadingAiResponse"
      >
        <mat-icon>send</mat-icon>
      </button>
      
    </div>
  </div>
</div>
